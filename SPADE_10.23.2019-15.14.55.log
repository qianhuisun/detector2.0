Oct 23, 2019 3:14:55 PM spade.core.Kernel addCommand INFO: Adding reporter: Audit
Oct 23, 2019 3:14:55 PM spade.reporter.Audit initKafkaProducer INFO: bootstrap.servers = 192.168.1.128:9092
Oct 23, 2019 3:14:55 PM spade.reporter.Audit initKafkaProducer INFO: acks = all
Oct 23, 2019 3:14:55 PM spade.reporter.Audit initKafkaProducer INFO: retries = 0
Oct 23, 2019 3:14:55 PM spade.reporter.Audit initKafkaProducer INFO: batch.size = 16384
Oct 23, 2019 3:14:55 PM spade.reporter.Audit initKafkaProducer INFO: linger.ms = 1
Oct 23, 2019 3:14:55 PM spade.reporter.Audit initKafkaProducer INFO: buffer.memory = 33554432
Oct 23, 2019 3:14:55 PM spade.reporter.Audit initKafkaProducer INFO: topic = abc7
Oct 23, 2019 3:14:55 PM spade.reporter.Audit initKafkaProducer INFO: repeat times = 1000
Oct 23, 2019 3:14:56 PM spade.utility.HostInfo$ReadFromOperatingSystem readTA1Version SEVERE: Failed to check if file is readable: /etc/tc-version
java.lang.Exception: Path does not exist
	at spade.utility.FileUtility.isFile(FileUtility.java:170)
	at spade.utility.FileUtility.isFileReadable(FileUtility.java:189)
	at spade.utility.HostInfo$ReadFromOperatingSystem.readTA1Version(HostInfo.java:250)
	at spade.utility.HostInfo$ReadFromOperatingSystem.readSafe(HostInfo.java:114)
	at spade.utility.HostInfo.generateCurrentHostFile(HostInfo.java:678)
	at spade.reporter.Audit.createHostVertex(Audit.java:265)
	at spade.reporter.Audit.initKafkaProducer(Audit.java:323)
	at spade.reporter.Audit.launch(Audit.java:810)
	at spade.core.Kernel.addCommand(Kernel.java:487)
	at spade.core.Kernel.executeCommand(Kernel.java:329)
	at spade.core.Kernel.configCommand(Kernel.java:377)
	at spade.core.Kernel.main(Kernel.java:195)

Oct 23, 2019 3:14:56 PM spade.core.AbstractReporter produceBytesMsgToKafka INFO: topic = abc7 value = [B@5d11346a
Oct 23, 2019 3:15:56 PM spade.reporter.Audit initFlagsFromArguments SEVERE: km flag is 'true': null
Oct 23, 2019 3:15:56 PM spade.reporter.Audit initFlagsFromArguments INFO: Audit flags: syscall=null, fileIO=true, netIO=true, units=true, waitForLog=true, netfilter=false, refineNet=false, localEndpoints=true, handleLocalEndpoints=true, failfast=true, mergeUnit=null, harden=false, reportKill=true
Oct 23, 2019 3:15:56 PM spade.reporter.Audit initFlagsFromArguments INFO: Audit flags (Globals): 'unixSockets'='true', 'versionNetworkSockets'='false', 'versionFiles'='true', 'versionMemorys'='true', 'versionNamedPipes'='true', 'versionUnnamedPipes'='true', 'versionUnknowns'='true', 'versionUnixSockets'='true', 'versionUnixSocketPairs'='true', 'versionNetworkSocketPairs'='false', 'versions'='false', 'epochs'='true', 'permissions'='true'
Oct 23, 2019 3:15:56 PM spade.utility.CommonFunctions createExternalMemoryMapInstance INFO: Audit[ArtifactsMap]: ExternalMemoryMap created with params: cache size=100,000, db path=tmp/artifactsDB_1571861756524, db name=artifactsDB_1571861756524, false positive prob=0, expected number of elements=1,000,000, reporting interval in millis=120,000
Oct 23, 2019 3:15:57 PM spade.utility.CommonFunctions createExternalMemoryMapInstance INFO: ProcessManager[ProcessUnitStatesMap]: ExternalMemoryMap created with params: cache size=66,000, db path=tmp/processStatesDB_1571861756961, db name=processStatesDB_1571861756961, false positive prob=0, expected number of elements=1,000,000, reporting interval in millis=120,000
Oct 23, 2019 3:15:57 PM spade.reporter.Audit runSpadeAuditBridge INFO: Succesfully executed the command: 'bin/spadeAuditBridge -u -s /var/run/audispd_events'
Oct 23, 2019 3:15:57 PM spade.reporter.Audit$2 run INFO: Starting get AuditEventReader Thread
Oct 23, 2019 3:15:58 PM spade.reporter.Audit listOfPidsToIgnore INFO: pidChecker is : java.lang.UNIXProcess@4562e04d
Oct 23, 2019 3:15:58 PM spade.reporter.Audit addNetworkKernelModule SEVERE: Kernel module controller 'lib/kernel-modules/netio_controller.ko' already exists.
Oct 23, 2019 3:15:58 PM spade.reporter.audit.AuditEventReader printStats INFO: Overall rate: 0 records/sec in 1.091 seconds. Interval rate: 0 records/sec in 1.091 seconds.
Oct 23, 2019 3:15:58 PM spade.reporter.Audit$1 run INFO: Exiting error reader thread for process: spadeAuditBridge
Oct 23, 2019 3:15:58 PM spade.utility.Execute$Output log INFO: Command "auditctl -D" succeeded with output: [No rules].
Oct 23, 2019 3:15:58 PM spade.utility.Execute$Output log INFO: Command "auditctl -D" succeeded with output: [No rules].
Oct 23, 2019 3:15:58 PM spade.utility.CommonFunctions closePrintSizeAndDeleteExternalMemoryMap INFO: Audit[ArtifactsMap]: Size of the external map on disk: 13 KB
Oct 23, 2019 3:15:58 PM spade.utility.CommonFunctions closePrintSizeAndDeleteExternalMemoryMap WARNING: Audit[ArtifactsMap]: Failed to get size of external map
java.lang.Exception: Does not exist. Failed to get size for path: tmp/artifactsDB_1571861756524
	at spade.utility.BerkeleyDB.sizeInBytesOfPersistedData(BerkeleyDB.java:146)
	at spade.utility.ExternalMemoryMap.getSizeOfPersistedDataInBytes(ExternalMemoryMap.java:429)
	at spade.utility.CommonFunctions.closePrintSizeAndDeleteExternalMemoryMap(CommonFunctions.java:241)
	at spade.reporter.audit.artifact.ArtifactManager.doCleanUp(ArtifactManager.java:660)
	at spade.reporter.Audit.doCleanup(Audit.java:785)
	at spade.reporter.Audit.access$600(Audit.java:55)
	at spade.reporter.Audit$2.run(Audit.java:1315)
	at java.lang.Thread.run(Thread.java:748)

Oct 23, 2019 3:15:58 PM spade.utility.CommonFunctions closePrintSizeAndDeleteExternalMemoryMap INFO: ProcessManager[ProcessUnitStatesMap]: Size of the external map on disk: 13 KB
Oct 23, 2019 3:15:58 PM spade.core.Kernel addCommand SEVERE: Unable to launch reporter
Oct 23, 2019 3:15:58 PM spade.utility.CommonFunctions closePrintSizeAndDeleteExternalMemoryMap WARNING: ProcessManager[ProcessUnitStatesMap]: Failed to get size of external map
java.lang.Exception: Does not exist. Failed to get size for path: tmp/processStatesDB_1571861756961
	at spade.utility.BerkeleyDB.sizeInBytesOfPersistedData(BerkeleyDB.java:146)
	at spade.utility.ExternalMemoryMap.getSizeOfPersistedDataInBytes(ExternalMemoryMap.java:429)
	at spade.utility.CommonFunctions.closePrintSizeAndDeleteExternalMemoryMap(CommonFunctions.java:241)
	at spade.reporter.audit.process.ProcessManager.doCleanUp(ProcessManager.java:237)
	at spade.reporter.Audit.doCleanup(Audit.java:788)
	at spade.reporter.Audit.access$600(Audit.java:55)
	at spade.reporter.Audit$2.run(Audit.java:1315)
	at java.lang.Thread.run(Thread.java:748)

Oct 23, 2019 3:15:58 PM spade.reporter.Audit$2 run INFO: Exiting event reader thread for process: spadeAuditBridge
Oct 23, 2019 3:34:13 PM spade.core.Kernel shutdown INFO: Shutting down SPADE....
Oct 23, 2019 3:34:13 PM spade.core.Kernel configCommand INFO: Usage not appropriate
Oct 23, 2019 3:34:13 PM spade.core.Kernel shutdown INFO: SPADE stopped.
